<?Lassoscript// Last modified 8/26/09 by ECL, Landmann InterActive// FUNCTIONALITY// Setup edit file; calls includes for setup functions// CHANGE NOTES// 11/23/07// Recoded for CMS v. 3.0// 11/29/07// Moving login check to kill session before navbar is displayed// 4/30/08// Added LI_CMSatend at bottom of page to set focus to login box// 1/15/09// Added new datatype "Story"// 6/19/09// Adding new datatype "Gallery"// 7/23/09// Added Robot Check// 8/26/09// Tighten up security on Users and Sys Settings to foil attempts of bookmark or link passingInclude:'/siteconfig.lasso';// Robot checkInclude:($svLibsPath)'robotcheck.inc';// Start the Admin sessionSession_Start: -Name=$svSessionAdminName, -Expires=$svSessionTimeout;// Convert action_paramsVar:'vDataType' = (Action_Param:'DataType');// Page headInclude:($svLibsPath)'page_header_admin.inc';// Determine which container to outputVar:'OutputOpenContainer' = string;Var:'OutputCloseContainer' = string;If: ($vDataType == 'Testimonial') || ($vDataType == 'User') || ($vDataType == 'Story');	$OutputOpenContainer = '\t\t\t<div class="contentcontainerwhite600">\n';	$OutputCloseContainer = '\t\t\t</div>\n';Else: ($vDataType == 'PortfolioEntry') || ($vDataType == 'PortfolioGroup') || ($vDataType == 'Content');	// Output nothing/If;// Debugging// Var:'svDebug' = 'Y';?><table width="780">	<tr>		<td width="170">			[Include:($svLibsPath)'navbar_main.inc']		</td>		<td><?Lassoscript// Output the opening container$OutputOpenContainer;// Login checkIf: (Var:'svUser_ID') != '';	If: $vDataType == 'Content';		Include:'/admin/frm_contentsearch.inc';		Include:($svLibsPath)'show_content.inc';	Else: $vDataType == 'Testimonial';		Include:'/admin/frm_testimonialsearch.inc';		Include:($svLibsPath)'show_testimonials.inc';	Else: $vDataType == 'Story';		Include:'/admin/frm_storiessearch.inc';		Include:($svLibsPath)'show_stories.inc';	Else: $vDataType == 'PortfolioGroup';		Include:'/admin/frm_portfoliogroupsearch.inc';		Include:($svLibsPath)'show_portfoliogroups.inc';	Else: $vDataType == 'PortfolioEntry';		Include:'/admin/frm_portfolioentrysearch.inc';		Include:($svLibsPath)'show_portfolioentries.inc';	Else: $vDataType == 'GalleryGroup';		Include:'/admin/frm_gallerygroupsearch.inc';		Include:($svLibsPath)'show_gallerygroups.inc';	Else: $vDataType == 'GalleryEntry';		Include:'/admin/frm_galleryentrysearch.inc';		Include:($svLibsPath)'show_galleryentries.inc';	Else: $vDataType == 'User';		// Display only to Superadmins		If($svUserPrivs_Priv == 'Superadmin');			Include:'/admin/frm_usersearch.inc';			Include:($svLibsPath)'show_users.inc';		// If wrong parameter passed, end the session, set error to 6004 "Access Restricted" and show login		Else;			Session_End: -Name=$svSessionAdminName;			Var:'svUser_ID' = '';			Var:'svUserLoginID' = '';			Var:'svUserPrivs_Priv' = '';			Var:'vError' = '6004';			Var:'URL' = ('login.lasso?Error='$vError);			If: $svDebug == 'Y';				'102: URL: ' $URL '<br>\n';				'<a href="'$URL'">' $URL '</a><br>\n';			Else;				Redirect_URL: $URL;			/If;		/If;	Else: $vDataType == 'Sys'; 		// Display only to Superadmins		If($svUserPrivs_Priv == 'Superadmin');			Include:'/admin/frm_sys.inc';		// If wrong parameter passed, end the session, set error to 6004 "Access Restricted" and show login		Else;			Session_End: -Name=$svSessionAdminName;			Var:'svUser_ID' = '';			Var:'svUserLoginID' = '';			Var:'svUserPrivs_Priv' = '';			Var:'vError' = '6004';			Var:'URL' = ('login.lasso?Error='$vError);			If: $svDebug == 'Y';				'125: URL: ' $URL '<br>\n';				'<a href="'$URL'">' $URL '</a><br>\n';			Else;				Redirect_URL: $URL;			/If;		/If;	// If wrong parameter passed, end the session, set error to 6004 "Access Restricted" and show login	Else;		Session_End: -Name=$svSessionAdminName;		Var:'svUser_ID' = '';		Var:'svUserLoginID' = '';		Var:'svUserPrivs_Priv' = '';		Var:'vError' = '6004';		Var:'URL' = ('login.lasso?Error='$vError);		If: $svDebug == 'Y';			'143: URL: ' $URL '<br>\n';			'<a href="'$URL'">' $URL '</a><br>\n';		Else;			Redirect_URL: $URL;		/If;	/If;Else;	// Set error to 6003 "Session Expired", redirect to login	Var:'vError' = '6003';	Var:'URL' = ('login.lasso?Error='$vError);	If: $svDebug == 'Y';		'156: URL: ' $URL '<br>\n';		'<a href="'$URL'">' $URL '</a><br>\n';	Else;		Redirect_URL: $URL;	/If;/If;// Output the closing container$OutputCloseContainer;?>		</td>	</tr></table>[Include:($svIncludesPath)'build_footer.inc'][OutputFooter]</body>[LI_CMSatend]</html>