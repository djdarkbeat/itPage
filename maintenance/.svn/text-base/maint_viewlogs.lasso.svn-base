<?Lassoscript// Last modified 5/12/08 by ECL, Landmann InterActive// FUNCTIONALITY// This page accesses the maintenance functions// CHANGE NOTES// 10/12/07// Recoded for CMS v. 3.0Include:'/siteconfig.lasso';// Start the sessionSession_Start: -Name=$svSessionAdminName, -Expires=$svSessionTimeout;// Page headInclude:($svLibsPath)'page_header_admin.inc';// Defining the DataTypeVar:'vDataType' = 'Maintenance';// Debugging// Var:'svDebug' = 'Y';?><table width="780">	<tr>		<td width="170">			[Include:($svLibsPath)'navbar_main.inc']		</td>		<td>			<div class="contentcontainerwhite"><?Lassoscript// Login checkIf: (Var:'svUser_ID') != '';?>			<h2>[LI_ShowIconByDataType]&nbsp;&nbsp;View Logs</h2>			<div align="left">Logfiles are named by their function plus a date label indicating the date and time that the function was run (2-digit month, 2-digit day, 4-digit year)</div><?Lassoscript	// Get files from the /logs folder	Inline: -Nothing, -Username=$svSiteUsername, -Password=$svSitePassword;		Local:'Result' = '';		Local:'WhichDir' = string;		Local:'WhichDir' = '/logs/';		Local:'File_Listing' = string;		Local:'x' = integer;		// List the directory		Local:'x' = 0;		Inline: -Nothing, -Username=$svSiteUsername, -Password=$svSitePassword;			#File_Listing = (File_ListDirectory: (#WhichDir));			If: $svDebug == 'Y';				'<p class="debug">43: File_Listing = ' #File_Listing' </p>\n';			/If;		/Inline;		// Display files in the directory		Loop: (#File_Listing->Size);			If: $svDebug == 'Y';				'<p class="debug">49: Loop_Count = ' (Loop_Count) '</p>\n';			/If;			If:(Loop_Count) != #x;				// This gets the filename				Local:'ThisFile' = (#File_Listing)->(get:(Loop_Count));					// Display file if not = .DS_Store or disabled with the SkipChar					If: !((#ThisFile)->BeginsWith:'.DS_');						Local('DirectoryName_Clean' = (#ThisFile));						If: $svDebug == 'Y';							'<p class="debug">\n'							'62: ThisFile = ' #ThisFile' <br>\n';							'62: DirectoryName_Clean = ' #DirectoryName_Clean' </p>\n';						/If;									If: #DirectoryName_Clean != '.DS_Store';							If: !((#DirectoryName_Clean)->(Contains:'/'));								// Build the link								'\t\t\t\t\t\t\t\t\t\t<br>\n';								'\t\t\t\t\t\t\t\t\t\t<a href="/logs/'(#DirectoryName_Clean)'" class="menuBoxContentLink">\n';								'<strong>' (#DirectoryName_Clean) '</strong></a>\n';							/If;						/If;					/If;			/If;		/Loop;	/Inline;	'\t\t\t</div>\n';Else;	// Dump out error 6004 "Access Restricted"	Var:'vError' = '6004';	// Standard Error Table	LI_ShowError3: -ErrNum=(Var:'vError'), -Option=(Var:'vOption');/If;?>			</div>		</td>	</tr></table>[Include:($svIncludesPath)'build_footer.inc']</body></html>